{% extends "agendamentos/base_publica.html" %}
{% load static %}

{% block content %}
<!-- Loader -->
<div id="site-loader" style="background:#fff;position:fixed;z-index:9999;inset:0;display:flex;align-items:center;justify-content:center;transition:.4s;flex-direction:column;">
  <img src="{% static 'agendamentos/img/submarca.png' %}" alt="BellCilios" style="height:85px;filter:drop-shadow(0 0 24px #e8d1a3);animation:loaderpulse 1.2s infinite;">
  <div style="margin-top:1.2rem;color:#a67c00;font-weight:600;letter-spacing:2px;font-size:1.05rem">Carregando beleza...</div>
</div>
<style>
@keyframes loaderpulse{0%{transform:scale(1);filter:drop-shadow(0 0 0 #e8d1a3)}50%{transform:scale(1.08);filter:drop-shadow(0 0 14px #a67c00)}100%{transform:scale(1);filter:drop-shadow(0 0 0 #e8d1a3)}}
</style>
<script>
document.addEventListener("DOMContentLoaded",function(){
  setTimeout(()=>{
    const l=document.getElementById('site-loader');
    if(l){l.style.opacity='0';setTimeout(()=>l.style.display='none',450);}
    const vid=document.querySelector('.hero-video video');
    if(vid){ vid.play().catch(()=>{}); }
  },900);
});
</script>

<div id="home-page">
  <style>
    /* HERO */
    #home-page .hero{ position:relative; min-height:78vh; display:grid; place-items:center; text-align:center; color:#fff; overflow:hidden; }
    #home-page .hero .hero-video{ position:absolute; inset:0; z-index:0; overflow:hidden; }
    #home-page .hero .hero-video video{ width:100%; height:100%; object-fit:cover; filter:brightness(.75) saturate(105%); }
    #home-page .hero::after{ content:""; position:absolute; inset:0; z-index:1; background:linear-gradient(180deg, rgba(0,0,0,.15) 0%, rgba(0,0,0,.35) 100%); }
    #home-page .hero .hero-content{ position:relative; z-index:2; }
    #home-page .hero h1{ font-family:"Playfair Display", serif; font-size:clamp(2.2rem,5vw,3.6rem); font-weight:800; color:#f8e9bf; margin-bottom:.75rem; text-shadow:0 2px 14px rgba(0,0,0,.35);}
    #home-page .hero p.lead{ font-size:clamp(1.05rem,2.3vw,1.25rem); color:#fff; text-shadow:0 1px 10px rgba(0,0,0,.3);}
    #home-page .cta{ display:inline-flex; align-items:center; gap:.5rem; margin-top:1.1rem; padding:.7rem 1.25rem; border:1px solid rgba(255,255,255,.55); color:#fff; border-radius:999px; backdrop-filter:blur(2px); transition:.2s; }
    #home-page .cta:hover{ border-color:#fff; transform:translateY(-1px); }
    #home-page .hero-curve{position:absolute;left:0;right:0;bottom:-1px;line-height:0;z-index:2}
    #home-page .hero-curve svg{width:100%;height:110px}
    #home-page .hero-curve .fill-next{fill:#fdfaff}

    /* CARDS */
    #home-page .services-showcase-section{ padding:3.25rem 0 4rem }
    #home-page .service-card{ border-radius:28px; border:none; overflow:hidden; min-height:470px; box-shadow:0 10px 30px rgba(170,140,30,0.10); background:#fff; transition:.25s; }
    #home-page .service-card:hover{ transform: translateY(-6px); box-shadow:0 14px 38px rgba(170,140,30,.16) }
    #home-page .media-wrap{ height:310px; background:#fafafa; display:flex; align-items:center; justify-content:center; }
    #home-page .media-wrap img,
    #home-page .carousel-inner img {
      max-height: 250px;
      width: auto;
      object-fit: contain;
      margin: 0 auto;
      display: block;
    }
    #home-page .card-body{ padding:1rem 1.1rem 1.35rem }
    #home-page .card-title{ color:#a38916; font-weight:700; font-size:1.18rem }

    /* BOTÕES FLUTUANTES ESQUERDA */
    .floating-social {
      position: fixed;
      left: 18px;
      bottom: 18px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      z-index: 1050;
    }
    .floating-social a {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 48px; height: 48px;
      border-radius: 50%;
      background: #a38916;
      color: #fff;
      font-size: 22px;
      box-shadow: 0 4px 10px rgba(0,0,0,.25);
      transition: transform .2s, background .2s;
    }
    .floating-social a:hover {
      transform: scale(1.1);
      background: #866d12;
      color:#fff;
    }
  </style>

  <!-- HERO -->
  <header class="hero">
    <div class="hero-video">
      <video autoplay muted loop playsinline preload="metadata" poster="{% static 'agendamentos/img/hero_poster.jpg' %}">
        <source src="{% static 'agendamentos/video/hero.mp4' %}" type="video/mp4">
      </video>
    </div>
    <div class="hero-content">
      <div class="container">
        <h1>Beleza começa pelo olhar</h1>
        <p class="lead">Design de Cílios e Formação Profissional para você se destacar.<br>Sinta-se linda, poderosa e confiante!</p>
        <a class="cta" target="_blank" href="https://wa.me/5571991806312?text=Ol%C3%A1%2C%20gostaria%20de%20agendar%20um%20hor%C3%A1rio%20com%20a%20BellCilios%21">
          <i class="bi bi-whatsapp"></i> Agende pelo WhatsApp
        </a>
      </div>
    </div>
    <div class="hero-curve">
      <svg viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M985.66,92.83C906.67,72,823.78,31,743.84,14.19c-82.26-17.34-168.06-16.33-250.45.39
                 -57.84,11.73-114,31.07-172,41.86A600.21,600.21,0,0,1,0,27.35V120H1200V95.8
                 C1132.19,118.92,1055.71,111.31,985.66,92.83Z" class="fill-next"></path></svg>
    </div>
  </header>

  <!-- SERVIÇOS -->
  <section class="services-showcase-section">
    <div class="container">
      <div class="row g-4 justify-content-center">

        <!-- Card 1: Design de Cílios -->
        <div class="col-12 col-md-6 col-lg-4">
          <div class="card service-card">
            <div id="carouselCilios" class="carousel slide" data-bs-ride="carousel" data-bs-interval="3000">
              <div class="carousel-inner">
                <div class="carousel-item active"><img src="{% static 'agendamentos/img/design_sobrancelha_1.png' %}" alt=""></div>
                <div class="carousel-item"><img src="{% static 'agendamentos/img/design_sobrancelha_2.png' %}" alt=""></div>
                <div class="carousel-item"><img src="{% static 'agendamentos/img/design_sobrancelha_3.png' %}" alt=""></div>
                <div class="carousel-item"><img src="{% static 'agendamentos/img/design_sobrancelha_4.png' %}" alt=""></div>
              </div>
            </div>
            <div class="card-body">
              <h5 class="card-title">Design de Cílios</h5>
              <p class="card-text">Cílios personalizados e harmonia perfeita para valorizar seu olhar.</p>
              <a class="btn btn-primary-custom mt-2" target="_blank"
                 href="https://wa.me/5571991806312?text=Ol%C3%A1%2C%20tenho%20interesse%20no%20servi%C3%A7o%20de%20Design%20de%20C%C3%ADlios!%20Poderia%20me%20dar%20mais%20informa%C3%A7%C3%B5es%3F">
                 Saiba mais
              </a>
            </div>
          </div>
        </div>

        <!-- Card 2: Cursos Profissionais -->
        <div class="col-12 col-md-6 col-lg-4">
          <a href="{% url 'curso' %}" class="text-decoration-none">
            <div class="card service-card h-100">
              <div id="carouselCursos" class="carousel slide" data-bs-ride="carousel" data-bs-interval="3000">
                <div class="carousel-inner">
                  <div class="carousel-item active"><img src="{% static 'agendamentos/img/cursos_profissonais_2.png' %}" alt=""></div>
                  <div class="carousel-item"><img src="{% static 'agendamentos/img/cursos_profissonais_3.png' %}" alt=""></div>
                  <div class="carousel-item"><img src="{% static 'agendamentos/img/cursos_profissonais_4.png' %}" alt=""></div>
                  <div class="carousel-item"><img src="{% static 'agendamentos/img/cursos_profissonais_5.png' %}" alt=""></div>
                </div>
              </div>
              <div class="card-body">
                <h5 class="card-title">Cursos Profissionais</h5>
                <p class="card-text">Cursos práticos, certificados e voltados para o sucesso na beleza.</p>
                <span class="btn btn-primary-custom mt-2">Saiba mais</span>
              </div>
            </div>
          </a>
        </div>

        <!-- Card 3: Maquiagem Profissional -->
        <div class="col-12 col-md-6 col-lg-4">
          <div class="card service-card h-100">
            <div id="carouselMaquiagem" class="carousel slide" data-bs-ride="carousel" data-bs-interval="3000">
              <div class="carousel-inner">
                <div class="carousel-item active"><img src="{% static 'agendamentos/img/maquiagem_1.png' %}" alt=""></div>
                <div class="carousel-item"><img src="{% static 'agendamentos/img/maquiagem_2.png' %}" alt=""></div>
                <div class="carousel-item"><img src="{% static 'agendamentos/img/maquiagem_3.png' %}" alt=""></div>
                <div class="carousel-item"><img src="{% static 'agendamentos/img/maquiagem_4.png' %}" alt=""></div>
                <div class="carousel-item"><img src="{% static 'agendamentos/img/maquiagem_5.png' %}" alt=""></div>
                <div class="carousel-item"><img src="{% static 'agendamentos/img/maquiagem_6.png' %}" alt=""></div>
                <div class="carousel-item"><img src="{% static 'agendamentos/img/maquiagem_7.png' %}" alt=""></div>
                <div class="carousel-item"><img src="{% static 'agendamentos/img/maquiagem_8.png' %}" alt=""></div>
              </div>
            </div>
            <div class="card-body">
              <h5 class="card-title">Maquiagem Profissional</h5>
              <p class="card-text">Realce sua beleza com técnicas modernas e produtos de alta qualidade.</p>
              <a class="btn btn-primary-custom mt-2" target="_blank"
                 href="https://wa.me/5571991806312?text=Ol%C3%A1%2C%20tenho%20interesse%20no%20servi%C3%A7o%20de%20Maquiagem%20Profissional!%20Poderia%20me%20dar%20mais%20informa%C3%A7%C3%B5es%3F">
                 Saiba mais
              </a>
            </div>
          </div>
        </div>

      </div>
    </div>
  </section>

  <!-- PROVA SOCIAL -->
  <section id="prova-social" class="py-5">
    <style>
      #prova-social .title{ text-align:center; margin-bottom: .75rem; color:#8c6c21 }
      #prova-social .muted{ text-align:center; color:#6b6b6b; margin-bottom:1.75rem }

      /* grid */
      #prova-social .grid{ display:grid; grid-template-columns:repeat(12,1fr); gap:16px }
      #prova-social .col{ grid-column:span 12 }
      @media (min-width:720px){ #prova-social .col{ grid-column:span 6 } }
      @media (min-width:992px){ #prova-social .col{ grid-column:span 3 } }

      /* Cartão com borda animada + brilhos */
      @property --angle{syntax:"<angle>"; initial-value:0deg; inherits:false}
      @keyframes spin{to{--angle:360deg}}
      @keyframes twinkle{0%,100%{opacity:0; transform:translateY(0) scale(.6)}
                         15%{opacity:1; transform:translateY(-2px) scale(1)} 60%{opacity:.35}}

      #prova-social .ps-card{
        position:relative; display:block; border-radius:14px; overflow:hidden; text-decoration:none;
        border:2px solid transparent;
        background:
          linear-gradient(#fff,#fff) padding-box,
          conic-gradient(from var(--angle), #ffd86b, #ffb347, #ffe7a6, #e6d6ff, #ffd86b) border-box;
        box-shadow:0 8px 24px rgba(0,0,0,.08);
        animation:spin 8s linear infinite;
      }
      #prova-social .ps-card:hover{ animation-duration:4s }
      #prova-social .ps-thumb{ width:100%; aspect-ratio:3/5; object-fit:cover; display:block; background:#f4f4f4 }
      #prova-social .ps-caption{ padding:10px 12px; background:#fff; color:#444 }
      #prova-social .sparkle{
        position:absolute; width:7px; height:7px; left:0; top:0; pointer-events:none; z-index:2;
        background:radial-gradient(circle,#fff,#ffe9a8 60%,transparent 70%);
        filter:drop-shadow(0 0 8px #fff8); border-radius:50%; mix-blend-mode:screen; opacity:0;
        animation:twinkle 3s ease-in-out infinite;
      }

      /* Modal simples */
      #psOverlay{ position:fixed; inset:0; background:rgba(0,0,0,.92); display:none;
                  align-items:center; justify-content:center; z-index:1055 }
      #psOverlay.open{ display:flex }
      #psOverlay .frame{
        padding:3px; border-radius:10px; border:2px solid transparent;
        background:
          linear-gradient(#0000,#0000) padding-box,
          conic-gradient(from var(--angle), #ffd86b, #ffb347, #ffe7a6, #e6d6ff, #ffd86b) border-box;
        animation:spin 8s linear infinite;
      }
      #psOverlay img{ max-width:96vw; max-height:88vh; object-fit:contain; display:block; border-radius:8px; background:#000 }
      #psOverlay .close, #psOverlay .navbtn{
        position:fixed; background:rgba(255,255,255,.14); border:1px solid rgba(255,255,255,.35);
        color:#fff; padding:8px 10px; border-radius:10px; backdrop-filter:blur(4px); cursor:pointer
      }
      #psOverlay .close{ top:14px; right:14px }
      #psOverlay .navbtn{ top:50%; transform:translateY(-50%) }
      #psOverlay .navbtn.left{ left:14px }
      #psOverlay .navbtn.right{ right:14px }
    </style>

    <div class="container">
      <h2 class="title">Prova Social</h2>
      <div class="muted">Feedbacks reais das clientes e alunas 💖</div>

      <div class="grid" id="psGrid">
        {% if provas %}
          {% for p in provas %}
            <div class="col">
              <a href="#" class="ps-card js-ps-open" data-full="{{ p.imagem.url }}">
                <img class="ps-thumb" src="{{ p.imagem.url }}" alt="{{ p.legenda|default:'Prova social' }}">
                <div class="ps-caption">
                  {{ p.legenda|default:"—" }}
                </div>
              </a>
            </div>
          {% endfor %}
        {% else %}
          {% for i in "1234" %}
            <div class="col">
              <a href="#" class="ps-card js-ps-open" data-full="{% static 'agendamentos/img/placeholder.png' %}">
                <img class="ps-thumb" src="{% static 'agendamentos/img/placeholder.png' %}" alt="Prova social">
                <div class="ps-caption">
                  Em breve depoimentos por aqui ✨
                </div>
              </a>
            </div>
          {% endfor %}
        {% endif %}
      </div>

      {% if provas and provas|length > 4 %}
      <div class="text-center mt-3">
        <a href="{% url 'resultados_alunas' %}" class="btn btn-outline-secondary">Ver mais resultados</a>
      </div>
      {% endif %}
    </div>

    <div id="psOverlay" role="dialog" aria-modal="true" aria-label="Visualização de prova social">
      <button class="close" id="psClose">✕</button>
      <button class="navbtn left" id="psPrev">◀</button>
      <div class="frame"><img id="psFull" alt=""></div>
      <button class="navbtn right" id="psNext">▶</button>
    </div>

    <script>
      // Abre modal e navega entre itens
      (function(){
        const items = Array.from(document.querySelectorAll('.js-ps-open'));
        const overlay = document.getElementById('psOverlay');
        const full = document.getElementById('psFull');
        const btnClose = document.getElementById('psClose');
        const btnPrev = document.getElementById('psPrev');
        const btnNext = document.getElementById('psNext');
        let idx = 0;

        function openAt(i){ idx=i; const url = items[idx].dataset.full || items[idx].querySelector('img').src; full.src = url; overlay.classList.add('open'); }
        function close(){ overlay.classList.remove('open'); full.removeAttribute('src'); }
        function prev(){ openAt((idx-1+items.length)%items.length); }
        function next(){ openAt((idx+1)%items.length); }

        items.forEach((a,i)=>a.addEventListener('click',e=>{ e.preventDefault(); openAt(i); }));
        btnClose.addEventListener('click', close);
        overlay.addEventListener('click', e=>{ if(e.target===overlay) close(); });
        btnPrev.addEventListener('click', prev);
        btnNext.addEventListener('click', next);
        document.addEventListener('keydown', e=>{
          if(!overlay.classList.contains('open')) return;
          if(e.key==='Escape') close();
          if(e.key==='ArrowLeft') prev();
          if(e.key==='ArrowRight') next();
        });
      })();

      // Brilhos aleatórios nos cartões
      (function(){
        const cards = document.querySelectorAll('#psGrid .ps-card');
        cards.forEach(card=>{
          for(let i=0;i<7;i++){
            const s=document.createElement('span');
            s.className='sparkle';
            s.style.left = (4 + Math.random()*92) + '%';
            s.style.top  = (6 + Math.random()*88) + '%';
            s.style.animationDelay = (Math.random()*3).toFixed(2)+'s';
            s.style.animationDuration = (2+Math.random()*3).toFixed(2)+'s';
            card.appendChild(s);
          }
        });
      })();
    </script>
  </section>
</div>

<!-- Botões Flutuantes -->
<div class="floating-social">
  <a href="https://www.instagram.com/bc_academyy?igsh=MXEweGVidXpkenFsbA==" target="_blank" aria-label="Instagram">
    <i class="bi bi-instagram"></i>
  </a>
  <a href="https://www.tiktok.com/@bellcilios22092?_t=ZM-8y89PNCTsEH&_r=1" target="_blank" aria-label="TikTok">
    <i class="bi bi-tiktok"></i>
  </a>
</div>
{% endblock %}
